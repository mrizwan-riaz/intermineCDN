(function(){var a={};var j={};j["noresults.eco"]=function(u){u||(u={});var w,q=[],o=function(r){return r&&r.ecoSafe?r:r!==void 0&&null!=r?v(r):""},s=u.safe,v=u.escape;return w=u.safe=function(r){if(r&&r.ecoSafe){return r}(void 0===r||null==r)&&(r="");var t=new String(r);return t.ecoSafe=!0,t},v||(v=u.escape=function(r){return(""+r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){q.push('<div class="alert alert-info">\n    <p>'),q.push(o(this.text||"The Widget has no results.")),q.push("</p>\n</div>")}).call(this)}.call(u),u.safe=s,u.escape=v,q.join("")};j["extra.eco"]=function(v){v||(v={});var w,u=[],r=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var x,y,t,s;if(u.push('<div class="group" style="display:inline-block;margin-right:5px;float:left">\n    <label>'),u.push(r(this.label)),u.push("</label>\n    "),this.possible.length>1){for(u.push('\n        <select name="'),u.push(r(this.label)),u.push('" class="span2">\n            '),s=this.possible,y=0,t=s.length;t>y;y++){x=s[y],u.push('\n                <option value="'),u.push(r(x)),u.push('" '),this.selected===x&&u.push(r('selected="selected"')),u.push(">\n                    "),u.push(r(x)),u.push("\n                </option>\n            ")}u.push("\n        </select>\n    ")}else{u.push("\n        "),u.push(r(this.possible[0])),u.push("\n    ")}u.push('\n</div>\n<div style="clear:both"></div>')}).call(this)}.call(v),v.safe=q,v.escape=o,u.join("")};j["invalidjsonkey.eco"]=function(v){v||(v={});var w,u=[],r=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){u.push('<li style="vertical-align:bottom">\n    <span style="display:inline-block" class="label label-important">'),u.push(r(this.key)),u.push("</span> is "),u.push(r(this.actual)),u.push("; was expecting "),u.push(r(this.expected)),u.push("\n</li>")}).call(this)}.call(v),v.safe=q,v.escape=o,u.join("")};j["error.eco"]=function(v){v||(v={});var w,u=[],r=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){u.push('<div class="alert alert-block">\n    <h4 class="alert-heading">'),u.push(r(this.title)),u.push(" for "),u.push(r(this.name)),u.push("</h4>\n    <p>"),u.push(this.text),u.push("</p>\n</div>")}).call(this)}.call(v),v.safe=q,v.escape=o,u.join("")};j["actions.eco"]=function(u){u||(u={});var v,o=[],q=u.safe,r=u.escape;return v=u.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},r||(r=u.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){o.push('<a class="btn btn-small view">View</a>\n<a class="btn btn-small export">Download</a>')}).call(this)}.call(u),u.safe=q,u.escape=r,o.join("")};j["loading.eco"]=function(s){s||(s={});var u,r=[],q=s.safe,o=s.escape;return u=s.safe=function(t){if(t&&t.ecoSafe){return t}(void 0===t||null==t)&&(t="");var v=new String(t);return v.ecoSafe=!0,v},o||(o=s.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="loading" style="background:rgba(255,255,255,0.9);position:absolute;top:0;left:0;height:100%;width:100%;text-align:center;">\n    <p style="padding-top:50%;font-weight:bold;">Loading &hellip;</p>\n</div>')}).call(this)}.call(s),s.safe=q,s.escape=o,r.join("")};j["popover.values.eco"]=function(v){v||(v={});var w,r=[],q=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},u=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var y,z,x,t;for(r.push("<h4>"),r.push(q(this.size)),r.push(" "),r.push(q(this.type)),1!==parseInt(this.size)&&r.push(q("s")),r.push(":</h4>\n\n"),t=this.values.slice(0,+(this.valuesLimit-1)+1||9000000000),z=0,x=t.length;x>z;z++){y=t[z],r.push('\n    <a href="#" class="match">'),r.push(q(y)),r.push("</a>\n")}r.push("\n"),this.values.length>this.valuesLimit&&r.push("&hellip;"),r.push("\n")}).call(this)}.call(v),v.safe=u,v.escape=o,r.join("")};j["popover.help.eco"]=function(v){v||(v={});var w,r=[],q=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},u=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="popover" style="position:absolute;top:5px;right:0;z-index:1;display: block;">\n    <div class="popover-inner">\n        <a style="cursor:pointer;margin:2px 5px 0 0" class="close">×</a>\n        <h3 class="popover-title">'),r.push(q(this.title)),r.push('</h3>\n        <div class="popover-content">\n            <p>'),r.push(q(this.text)),r.push("</p>\n        </div>\n    </div>\n</div>")}).call(this)}.call(v),v.safe=u,v.escape=o,r.join("")};j["popover.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="popover" style="position:absolute;top:5px;right:0;z-index:1;display:block">\n    <div class="popover-inner" style="'),r.push(u(this.style)),r.push('">\n        <a style="cursor:pointer;margin:2px 5px 0 0" class="close">×</a>\n        <h3 class="popover-title">\n            '),r.push(u(this.description.slice(0,+(this.descriptionLimit-1)+1||9000000000))),r.push("\n            "),this.description.length>this.descriptionLimit&&r.push("&hellip;"),r.push('\n        </h3>\n        <div class="popover-content">\n            <div class="values">\n                <!-- popover.values.eco -->\n            </div>\n            <div style="margin-top:10px">\n                <a class="btn btn-small btn-primary results">View results</a>\n                <a class="btn btn-small list">Create list</a>\n            </div>\n        </div>\n    </div>\n</div>')}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.correction.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="group correction" style="display:inline-block;margin-right:5px;float:left;height:60px">\n    <label>Normalise by length <em class="badge badge-info" style="font-size:11px;font-family:serif;padding:1px 3px;border-radius:2px">i</em><div class="help"></div></label>\n    <p style="width:300px">\n    <input type="checkbox" class="correction" '),this.gene_length_correction&&r.push('checked="checked"'),r.push(" >\n    "),this.percentage_gene_length_not_null&&(r.push("\n    	"),r.push(u(this.percentage_gene_length_not_null)),r.push(' of genes in your list do not have a length and will be discarded, <a class="which" style="cursor:pointer">see which</a>.\n    ')),r.push("\n    </p>\n</div>")}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.populationlist.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var A,C,t,s,x,B,y,z;for(r.push('<table class="table table-striped">\n    <tbody>\n        <tr><td>\n            '),null==this.current?r.push('\n                <strong><a href="#">Default</a></strong>\n            '):r.push('\n                <a href="#">Default</a>\n            '),r.push("\n        </td></tr>\n        "),y=this.lists,t=0,x=y.length;x>t;t++){for(A=y[t],r.push("\n            <tr><td>\n                "),A.name===this.current?(r.push("\n                    <strong>\n                        <a "),A.description&&(r.push('title="'),r.push(u(A.description)),r.push('"')),r.push(' href="#">'),r.push(u(A.name)),r.push("</a> ("),r.push(u(A.size)),r.push(")\n                    </strong>\n                ")):(r.push("\n                    <a "),A.description&&(r.push('title="'),r.push(u(A.description)),r.push('"')),r.push(' href="#">'),r.push(u(A.name)),r.push("</a> ("),r.push(u(A.size)),r.push(")\n                ")),r.push("\n                \n                "),z=A.tags,s=0,B=z.length;B>s;s++){C=z[s],r.push('\n                    <span class="label" style="vertical-align:text-bottom">'),r.push(u(C)),r.push("</span>\n                ")}r.push("\n            </td></tr>\n        ")}r.push("\n    </tbody>\n</table>")}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.table.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<!-- actual fixed head -->\n<div class="head" style="display:table">\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;"><input type="checkbox" class="check" /></div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;">'),r.push(u(this.label)),r.push('</div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;white-space:nowrap">p-Value <a href="http://intermine.readthedocs.org/en/latest/embedding/list-widgets/enrichment-widgets/" target="_blank" class="badge badge-info" style="font-size:11px;font-family:serif;padding:1px 3px;border-radius:2px;font-style:italic;color:#FFF!important">i</a></div>\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;">Matches</div>\n    <div style="clear:both"></div>\n</div>\n<div class="wrapper" style="overflow:auto;overflow-x:hidden">\n    <table class="table table-striped">\n        <!-- head for proper cell width -->\n        <thead style="visibility:hidden">\n            <tr>\n                <th></th>\n                <th>'),r.push(u(this.label)),r.push("</th>\n                <th>p-Value</th>\n                <th>Matches</th>\n            </tr>\n        </thead>\n        <tbody>\n            <!-- loop enrichment.row.eco -->\n        </tbody>\n    </table>\n</div>")}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.form.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var A,C,t,s,x,y,B,z;for(r.push('<form style="margin:0">\n    <div class="group" style="display:inline-block;margin-right:5px;float:left;height:60px">\n        <label>Test Correction</label>\n        <select name="errorCorrection" class="span2">\n            '),B=this.errorCorrections,t=0,x=B.length;x>t;t++){A=B[t],r.push('\n                <option value="'),r.push(u(A)),r.push('" '),this.options.errorCorrection===A&&r.push(u('selected="selected"')),r.push(">\n                    "),r.push(u(A)),r.push("\n            </option>\n            ")}for(r.push('\n        </select>\n    </div>\n\n    <div class="group" style="display:inline-block;margin-right:5px;float:left;height:60px">\n        <label>Max p-value</label>\n        <select name="pValue" class="span2">\n            '),z=this.pValues,s=0,y=z.length;y>s;s++){C=z[s],r.push('\n                <option value="'),r.push(u(C)),r.push('" '),this.options.pValue===C&&r.push(u('selected="selected"')),r.push(">\n                    "),r.push(u(C)),r.push("\n                </option>\n            ")}r.push('\n        </select>\n    </div>\n</form>\n<div style="clear:both"></div>')}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.population.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="group background" style="display:inline-block;margin-right:5px;float:left;height:60px">\n    <label>Background population</label>\n    '),r.push(u(this.current)),r.push(' <a class="btn btn-small change">Change</a>\n\n    <div class="popover" style="position:absolute;top:0;right:0;z-index:1;display:none">\n        <div class="popover-inner">\n            <a style="cursor:pointer;margin:2px 5px 0 0" class="close">×</a>\n            <h4 class="popover-title">Change background population</h4>\n            <div class="popover-content">\n                <p style="margin-bottom:5px">\n                    '),this.loggedIn?r.push('\n                        <input type="checkbox" class="save" style="vertical-align:top" /> Save your preference for next time\n                    '):r.push("\n                        Login to save your preference for next time\n                    "),r.push('\n                </p>\n\n                <input type="text" class="filter" style="width:96%" placeholder="Filter..." />\n                \n                <div class="values" style="max-height:300px;overflow-y:auto">\n                    <!-- enrichment.populationlist.eco -->\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.row.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?o(s):""},q=v.safe,o=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<td class="check"><input type="checkbox" '),this.row.selected&&r.push('checked="checked"'),r.push(' /></td>\n<td class="description">\n    '),r.push(u(this.row.description)),r.push("\n    "),this.row.externalLink&&(r.push('\n        [<a href="'),r.push(this.row.externalLink),r.push('" target="_blank">'),r.push(u(this.row.identifier)),r.push("</a>]\n    ")),r.push('\n</td>\n<td class="pValue" style="white-space:nowrap">'),r.push(u(this.row["p-value"])),r.push('</td>\n<td class="matches">\n    <a class="count" style="cursor:pointer">'),r.push(u(this.row.matches)),r.push("</a>\n</td>")}).call(this)}.call(v),v.safe=q,v.escape=o,r.join("")};j["enrichment.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?q(s):""},o=v.safe,q=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},q||(q=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="header">\n    <h3>'),this.title&&r.push(u(this.title)),r.push("</h3>\n    <p>"),this.description&&r.push(this.description),r.push("</p>\n    "),this.notAnalysed?(r.push("\n        <p>Number of "),r.push(u(this.type)),r.push("s in this list not analysed in this widget: <a>"),r.push(u(this.notAnalysed)),r.push("</a></p>\n    ")):r.push("\n        <p>All items in your list have been analysed.</p>\n    "),r.push('\n\n    <div class="form">\n        <!-- enrichment.form.eco -->\n    </div>\n\n    <div class="actions" style="padding:10px 0">\n        <!-- actions.eco -->\n    </div>\n</div>\n<div class="content">\n    <!-- enrichment.table.eco -->\n</div>')}).call(this)}.call(v),v.safe=o,v.escape=q,r.join("")};j["chart.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?q(s):""},o=v.safe,q=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},q||(q=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="header">\n    <h3>'),this.title&&r.push(u(this.title)),r.push("</h3>\n    <p>"),this.description&&r.push(this.description),r.push("</p>\n    "),this.notAnalysed?(r.push("\n        <p>Number of "),r.push(u(this.type)),r.push("s in this list not analysed in this widget: <a>"),r.push(u(this.notAnalysed)),r.push("</a></p>\n    ")):r.push("\n        <p>All items in your list have been analysed.</p>\n    "),r.push('\n\n    <div class="form">\n        <form style="margin:0">\n            <!-- extra.eco -->\n        </form>\n    </div>\n\n    <div class="actions" style="padding:10px 0">\n        <!-- chart.actions.eco -->\n    </div>\n</div>\n<div class="content"></div>')}).call(this)}.call(v),v.safe=o,v.escape=q,r.join("")};j["chart.actions.eco"]=function(u){u||(u={});var v,q=[],r=u.safe,o=u.escape;return v=u.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},o||(o=u.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){q.push('<a class="btn btn-small view-all">View in table</a>')}).call(this)}.call(u),u.safe=r,u.escape=o,q.join("")};j["table.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?q(s):""},o=v.safe,q=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},q||(q=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){r.push('<div class="header">\n    <h3>'),this.title&&r.push(u(this.title)),r.push("</h3>\n    <p>"),this.description&&r.push(this.description),r.push("</p>\n    "),this.notAnalysed?(r.push("\n        <p>Number of "),r.push(u(this.type)),r.push("s in this list not analysed in this widget: <a>"),r.push(u(this.notAnalysed)),r.push("</a></p>\n    ")):r.push("\n        <p>All items in your list have been analysed.</p>\n    "),r.push('\n\n    <div class="actions" style="padding:10px 0">\n        <!-- actions.eco -->\n    </div>\n</div>\n<div class="content">\n    <!-- table.table.eco -->\n</div>')}).call(this)}.call(v),v.safe=o,v.escape=q,r.join("")};j["table.table.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?q(s):""},o=v.safe,q=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},q||(q=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var z,B,t,x,s,A,y;for(r.push('<!-- actual fixed head -->\n<div class="head" style="display:table">\n    <div style="font-weight:bold;display:table-cell;padding:0 8px;"><input type="checkbox" class="check" /></div>\n    '),A=this.columns,B=0,x=A.length;x>B;B++){z=A[B],r.push('\n        <div style="font-weight:bold;display:table-cell;padding:0 8px;">'),r.push(u(z)),r.push("</div>\n    ")}for(r.push('\n    <div style="clear:both"></div>\n</div>\n<div class="wrapper" style="overflow:auto;overflow-x:hidden">\n    <table class="table table-striped">\n        <!-- head for proper cell width -->\n        <thead style="visibility:hidden">\n            <tr>\n                <th></th>\n                '),y=this.columns,t=0,s=y.length;s>t;t++){z=y[t],r.push("\n                    <th>"),r.push(u(z)),r.push("</th>\n                ")}r.push("\n            </tr>\n        </thead>\n        <tbody>\n            <!-- loop table.row.eco -->\n        </tbody>\n    </table>\n</div>")}).call(this)}.call(v),v.safe=o,v.escape=q,r.join("")};j["table.row.eco"]=function(v){v||(v={});var w,r=[],u=function(s){return s&&s.ecoSafe?s:s!==void 0&&null!=s?q(s):""},o=v.safe,q=v.escape;return w=v.safe=function(s){if(s&&s.ecoSafe){return s}(void 0===s||null==s)&&(s="");var t=new String(s);return t.ecoSafe=!0,t},q||(q=v.escape=function(s){return(""+s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var x,y,s,t;for(r.push('<td class="check"><input type="checkbox" '),this.row.selected&&r.push('checked="checked"'),r.push(" /></td>\n"),t=this.row.descriptions,y=0,s=t.length;s>y;y++){x=t[y],r.push("\n    <td>"),r.push(u(x)),r.push("</td>\n")}r.push('\n<td class="matches">\n    <a class="count" style="cursor:pointer">'),r.push(u(this.row.matches)),r.push("</a>\n</td>")}).call(this)}.call(v),v.safe=o,v.escape=q,r.join("")};var e,n,b,h,f,m,l,d,k={}.hasOwnProperty,c=function(s,q){for(var o in q){if(k.call(q,o)){s[o]=q[o]}}function r(){this.constructor=s}r.prototype=q.prototype;s.prototype=new r();s.__super__=q.prototype;return s},i=function(o,q){return function(){return o.apply(q,arguments)}},p=[].indexOf||function(r){for(var q=0,o=this.length;q<o;q++){if(q in this&&this[q]===r){return q}}return -1},g=[].slice;l={};l.Root=(function(){function o(){}o.prototype.result=false;o.prototype.is=function(){return this.result};o.prototype.toString=function(){return""+this.expected+" but got "+this.actual};return o})();l.isString=(function(q){c(o,q);o.prototype.expected="String";function o(r){this.actual=r;this.result=typeof r==="string"}return o})(l.Root);l.isStringOrNull=(function(o){c(q,o);q.prototype.expected="String or Null";function q(r){this.actual=r;this.result=r===null||typeof r==="string"}return q})(l.Root);l.isInteger=(function(o){c(q,o);q.prototype.expected="Integer";function q(r){this.actual=r;this.result=typeof r==="number"}return q})(l.Root);l.isBoolean=(function(q){c(o,q);o.prototype.expected="Boolean true";function o(r){this.actual=r;this.result=typeof r==="boolean"}return o})(l.Root);l.isBooleanOrNull=(function(o){c(q,o);q.prototype.expected="Boolean or Null";function q(r){this.actual=r;this.result=r===null||typeof r==="boolean"}return q})(l.Root);l.isNull=(function(q){c(o,q);o.prototype.expected="Null";function o(r){this.actual=r;this.result=r===null}return o})(l.Root);l.isArray=(function(q){c(o,q);o.prototype.expected="Array";function o(r){this.actual=r;this.result=r instanceof Array}return o})(l.Root);l.isHTTPSuccess=(function(o){c(q,o);q.prototype.expected="HTTP code 200";function q(r){this.actual=r;this.result=r===200}return q})(l.Root);l.isJSON=(function(q){c(o,q);o.prototype.expected="JSON Object";function o(t){var r;this.actual=t;this.result=true;try{JSON.parse(t)}catch(s){r=s;this.result=false}}return o})(l.Root);l.isUndefined=(function(q){c(o,q);function o(){d=o.__super__.constructor.apply(this,arguments);return d}o.prototype.expected="it to be undefined";return o})(l.Root);n=(function(){o.prototype.mime="text/plain";o.prototype.charset="utf-8";function o(s,r){var q;if(r==null){r="widget.tsv"}q=new Blob([s],{type:""+this.mime+";charset="+this.charset});saveAs(q,r)}return o})();b=(function(){function o(r,t){var s,q,u=this;q=window.open();if((q==null)||typeof q==="undefined"){r.after(this.msg=e("<span/>",{style:"margin-left:5px","class":"label label-inverse",text:"Please enable popups"}))}else{q.document.open();q.document.write("<pre>"+t+"</pre>");q.document.close()}s=function(){var v;return(v=u.msg)!=null?v.fadeOut():void 0};setTimeout(s,5000)}return o})();if(!Array.prototype.indexOf){Array.prototype.indexOf=function(q){var r,o;o=this.length>>>0;r=Number(arguments[1])||0;r=(r<0?Math.ceil(r):Math.floor(r));if(r<0){r+=o}while(r<o){if(r in this&&this[r]===q){return r}r++}return -1}}m=function(r,q){var o;for(o in q){if(r[o]==null){if(Object.prototype.hasOwnProperty.call(q,o)){r[o]=q[o]}}}return r};f=function(L){var O,U,K,v,H,G,X,J,M,I,q,C,Q,o,r,s,E,P,N,F,D,Z,Y,W,V,T,S,R,B,A,z,y,x,w,u,t;o=(function(){function aa(){this.queryRows=i(this.queryRows,this);this.error=i(this.error,this);this.validateType=i(this.validateType,this);this.template=i(this.template,this);var ab=this;this.log=this.log||[];this.log.push("Creating wrapping element");e(this.el).html(e("<div/>",{"class":"inner",style:"height:572px;overflow:hidden;position:relative"}));this.el=""+this.el+" div.inner";this.log.push("Initializing InterMine Service");this._service=new intermine.Service({root:this.service,token:this.token});this.log.push("Monitoring for debug mode");e(window).on("hashchange",function(){if(window.location.hash==="#debug"){return e(ab.el).append(e("<a/>",{"class":"btn btn-small btn-warning",text:"Debug",style:"z-index:5;position:absolute;display:block;top:0;left:0",click:function(){var ac;ac=e("<pre/>",{html:ab.log.join("\n\n")});return e(ab.el).css("overflow","scroll").html(ac)}}))}})}aa.prototype.template=function(ac,ad){var ab;if(ad==null){ad={}}this.log.push("Get eco template `"+ac+"`");return typeof j[ab=""+ac+".eco"]==="function"?j[ab](ad):void 0};aa.prototype.validateType=function(ad,ac){var ab,ae,af,ag;this.log.push("Validating "+JSON.stringify(ad));ab=[];for(ae in ad){ag=ad[ae];af=typeof ac[ae]==="function"?new ac[ae](ag):void 0;if(af&&!af.is()){ab.push(this.template("invalidjsonkey",{key:ae,actual:af.is(),expected:new String(af)}))}}if(ab.length){return this.error(ab,"JSONResponse")}};aa.prototype.error=function(ac,ab){if(ac==null){ac={title:"Error",text:"Generic error"}}ac.name=this.name||this.id;switch(ab){case"AJAXTransport":ac.title="AJAX Request Failed";break;case"JSONResponse":ac.title="Invalid JSON Response";ac.text="<ol>"+(ac.join(""))+"</ol>"}e(this.el).html(this.template("error",ac));this.log.push(ac.title);return this.fireEvent({event:"error",type:ab,message:ac.title})};aa.prototype.fireEvent=function(ae){var ab,ac,ad;ab=document.createEvent("Events");ab.initEvent("InterMine",true,true);for(ac in ae){ad=ae[ac];ab[ac]=ad}ab.source="ListWidgets";ab.widget={id:this.id,bag:this.bagName,el:this.el,service:this.service};return window.dispatchEvent(ab)};aa.prototype.queryRows=function(ad,ac){var ab;this.log.push("Querying for rows");ab=this._service;return async.waterfall([function(ae){return ab.query(ad,function(af){return ae(null,af)})},function(af,ae){return af.rows(function(ag){return ae(null,ag)})}],function(af,ae){return ac(ae)})};return aa})();F=(function(ab){c(aa,ab);aa.prototype.widgetOptions={title:true,description:true,matchCb:function(ad,ac){return typeof console!=="undefined"&&console!==null?console.log(ad,ac):void 0},resultsCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0},listCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0}};aa.prototype.spec={response:{columnTitle:l.isString,title:l.isString,description:l.isString,pathQuery:l.isString,columns:l.isString,pathConstraint:l.isString,requestedAt:l.isString,list:l.isString,type:l.isString,notAnalysed:l.isInteger,results:l.isArray,wasSuccessful:l.isBoolean,error:l.isNull,statusCode:l.isHTTPSuccess}};function aa(ac,ad,ah,af,ae,ag){this.service=ac;this.token=ad;this.id=ah;this.bagName=af;this.el=ae;if(ag==null){ag={}}this.render=i(this.render,this);this.widgetOptions=m(ag,this.widgetOptions);this.log=[];aa.__super__.constructor.call(this);this.render()}aa.prototype.render=function(){var ae,ad,ac,af=this;ad=window.setTimeout((function(){return e(af.el).append(af.loading=e(af.template("loading")))}),400);if((ac=this.view)!=null){ac.undelegateEvents()}ae={widget:this.id,list:this.bagName,token:this.token};this.log.push("Sending data payload "+JSON.stringify(ae));return e.ajax({url:""+this.service+"list/table?format=json",dataType:"jsonp",data:ae,success:function(ag){var ah;af.log.push("Received a response "+JSON.stringify(ag));window.clearTimeout(ad);if((ah=af.loading)!=null){ah.remove()}af.validateType(ag,af.spec.response);if(ag.wasSuccessful){af.name=ag.title;af.log.push("Creating new TableView");return af.view=new N({widget:af,el:af.el,template:af.template,response:ag,options:af.widgetOptions})}},error:function(ai,ag,ah){clearTimeout(ad);return af.error({text:""+af.service+"list/table"},"AJAXTransport")}})};return aa})(o);Q=(function(aa){c(ab,aa);ab.prototype.widgetOptions={title:true,description:true,matchCb:function(ad,ac){return typeof console!=="undefined"&&console!==null?console.log(ad,ac):void 0},resultsCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0},listCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0}};ab.prototype.errorCorrections=["Holm-Bonferroni","Benjamini Hochberg","Bonferroni","None"];ab.prototype.pValues=["0.05","0.10","1.00"];ab.prototype.spec={response:{title:l.isString,description:l.isString,pathQuery:l.isJSON,pathConstraint:l.isString,error:l.isNull,list:l.isString,notAnalysed:l.isInteger,requestedAt:l.isString,results:l.isArray,label:l.isString,statusCode:l.isHTTPSuccess,type:l.isString,wasSuccessful:l.isBoolean,filters:l.isString,filterLabel:l.isString,filterSelectedValue:l.isString,externalLink:l.isString,pathQueryForMatches:l.isString,is_logged:l.isBoolean,current_population:l.isStringOrNull,message:l.isString,extraAttribute:l.isStringOrNull}};function ab(ad,ae,ac,ai,ag,af,ah){this.service=ad;this.token=ae;this.lists=ac;this.id=ai;this.bagName=ag;this.el=af;if(ah==null){ah={}}this.render=i(this.render,this);this.widgetOptions=m(ah,this.widgetOptions);this.formOptions={errorCorrection:"Holm-Bonferroni",pValue:"0.05"};this.log=[];ab.__super__.constructor.call(this);this.render()}ab.prototype.render=function(){var ag,ad,af,ae,ac,ai,ah=this;af=window.setTimeout((function(){return e(ah.el).append(ah.loading=e(ah.template("loading")))}),400);if((ac=this.view)!=null){ac.undelegateEvents()}ag={widget:this.id,list:this.bagName,correction:this.formOptions.errorCorrection,maxp:this.formOptions.pValue,token:this.token};ai=this.formOptions;for(ad in ai){ae=ai[ad];if(ad!=="errorCorrection"&&ad!=="pValue"&&ad!=="current_population"&&ad!=="remember_population"&&ad!=="gene_length_correction"){ad="filter"}ag[ad]=ae}this.log.push("Sending data payload "+JSON.stringify(ag));return e.ajax({url:""+this.service+"list/enrichment?format=json",dataType:"jsonp",data:ag,success:function(al){var ak,aj,am;ah.log.push("Received a response "+JSON.stringify(al));window.clearTimeout(af);if((am=ah.loading)!=null){am.remove()}ah.validateType(al,ah.spec.response);if(al.wasSuccessful){ah.name=al.title;aj=(function(){var ap,ao,aq,an;aq=this.lists;an=[];for(ap=0,ao=aq.length;ap<ao;ap++){ak=aq[ap];if(ak.type===al.type&&ak.size!==0){an.push(ak)}}return an}).call(ah);ah.log.push("Creating new EnrichmentView");return ah.view=new C({widget:ah,el:ah.el,template:ah.template,response:al,form:{options:ah.formOptions,pValues:ah.pValues,errorCorrections:ah.errorCorrections},options:ah.widgetOptions,lists:aj})}},error:function(al,aj,ak){clearTimeout(af);return ah.error({text:""+ah.service+"list/enrichment"},"AJAXTransport")}})};return ab})(o);K=(function(ab){c(aa,ab);aa.prototype.widgetOptions={title:true,description:true,matchCb:function(ad,ac){return typeof console!=="undefined"&&console!==null?console.log(ad,ac):void 0},resultsCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0},listCb:function(ac){return typeof console!=="undefined"&&console!==null?console.log(ac):void 0}};aa.prototype.formOptions={};aa.prototype.spec={response:{chartType:l.isString,description:l.isString,error:l.isNull,list:l.isString,notAnalysed:l.isInteger,pathQuery:l.isString,requestedAt:l.isString,results:l.isArray,seriesLabels:l.isString,seriesValues:l.isString,statusCode:l.isHTTPSuccess,title:l.isString,type:l.isString,wasSuccessful:l.isBoolean,filters:l.isString,filterLabel:l.isString,filterSelectedValue:l.isString,simplePathQuery:l.isString,domainLabel:l.isString,rangeLabel:l.isString}};function aa(ac,ad,ah,af,ae,ag){this.service=ac;this.token=ad;this.id=ah;this.bagName=af;this.el=ae;if(ag==null){ag={}}this.render=i(this.render,this);this.widgetOptions=m(ag,this.widgetOptions);this.log=[];aa.__super__.constructor.call(this);this.render()}aa.prototype.render=function(){var ag,ad,af,ae,ac,ai,ah=this;af=window.setTimeout((function(){return e(ah.el).append(ah.loading=e(ah.template("loading")))}),400);if((ac=this.view)!=null){ac.undelegateEvents()}ag={widget:this.id,list:this.bagName,token:this.token};ai=this.formOptions;for(ad in ai){ae=ai[ad];if(ad!=="errorCorrection"&&ad!=="pValue"){ag.filter=ae}}this.log.push("Sending data payload "+JSON.stringify(ag));return e.ajax({url:""+this.service+"list/chart?format=json",dataType:"jsonp",data:ag,success:function(aj){var ak;ah.log.push("Received a response "+JSON.stringify(aj));window.clearTimeout(af);if((ak=ah.loading)!=null){ak.remove()}ah.validateType(aj,ah.spec.response);if(aj.wasSuccessful){ah.name=aj.title;ah.log.push("Creating new ChartView");return ah.view=new U({widget:ah,el:ah.el,template:ah.template,response:aj,form:{options:ah.formOptions},options:ah.widgetOptions})}},error:function(al,aj,ak){clearTimeout(af);return ah.error({text:""+ah.service+"list/chart"},"AJAXTransport")}})};return aa})(o);H=(function(ab){c(aa,ab);function aa(){this.toggleSelected=i(this.toggleSelected,this);this.validate=i(this.validate,this);D=aa.__super__.constructor.apply(this,arguments);return D}aa.prototype.defaults={selected:false};aa.prototype.initialize=function(ad,ac){this.widget=ac;return this.validate(ad)};aa.prototype.validate=function(ac){return this.widget.validateType(ac,this.spec)};aa.prototype.toggleSelected=function(){return this.set({selected:!this.get("selected")})};return aa})(L.Model);v=(function(aa){c(ab,aa);function ab(){B=ab.__super__.constructor.apply(this,arguments);return B}ab.prototype.model=H;ab.prototype.selected=function(){return this.filter(function(ac){return ac.get("selected")})};ab.prototype.toggleSelected=function(){var aj,ai,ag,ak,ac,ae,ad,ah,af;if(this.models.length-this.selected().length){ae=this.models;ah=[];for(ai=0,ak=ae.length;ai<ak;ai++){aj=ae[ai];ah.push(aj.set({selected:true},{silent:true}))}return ah}else{ad=this.models;af=[];for(ag=0,ac=ad.length;ag<ac;ag++){aj=ad[ag];af.push(aj.set({selected:false},{silent:true}))}return af}};return ab})(L.Collection);I=(function(aa){c(ab,aa);function ab(){A=ab.__super__.constructor.apply(this,arguments);return A}ab.prototype.spec={description:l.isString,identifier:l.isString,matches:l.isInteger,"p-value":l.isInteger,selected:l.isBoolean,externalLink:l.isString};ab.prototype.toJSON=function(){var ac;ac=_.clone(this.attributes);if(ac["p-value"]<0.001){ac["p-value"]=ac["p-value"].toExponential(6)}else{ac["p-value"]=ac["p-value"].toFixed(6)}return ac};return ab})(H);M=(function(aa){c(ab,aa);function ab(){z=ab.__super__.constructor.apply(this,arguments);return z}ab.prototype.model=I;return ab})(v);E=(function(ab){c(aa,ab);function aa(){y=aa.__super__.constructor.apply(this,arguments);return y}aa.prototype.spec={matches:l.isInteger,identifier:l.isInteger,descriptions:l.isArray,selected:l.isBoolean};return aa})(H);s=(function(ab){c(aa,ab);function aa(){x=aa.__super__.constructor.apply(this,arguments);return x}aa.prototype.model=E;return aa})(v);G=(function(aa){c(ab,aa);function ab(){this.seeWhich=i(this.seeWhich,this);this.toggleCull=i(this.toggleCull,this);this.hideHelp=i(this.hideHelp,this);this.showHelp=i(this.showHelp,this);this.render=i(this.render,this);w=ab.__super__.constructor.apply(this,arguments);return w}ab.prototype.help="Depending on the type of experiment your data comes from, it is sometimes \nnecessary to normalize by gene length in order to get the correct p-values. \nIf your data comes from a genome-wide binding experiment such as ChIP-seq \nor DamID, binding intervals are more likely to be associated with longer \ngenes than shorter ones, and you should therefore normalize by gene length. \nThis is not the case for experiments such as gene expression studies, where \ngene length does not play a role in the likelihood that a particular set of \ngenes will be overrepresented in the list.";ab.prototype.events={"click .correction input.correction":"toggleCull","click .correction a.which":"seeWhich","hover .correction label .badge":"showHelp","click .correction a.close":"hideHelp"};ab.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}if(this.gene_length_correction!==null){return this.render()}};ab.prototype.render=function(){e(this.el).append(this.widget.template("enrichment.correction",this));return this};ab.prototype.showHelp=function(){return e(this.el).find(".help").html(this.widget.template("popover.help",{title:'What does "Normalise by length" mean?',text:this.help}))};ab.prototype.hideHelp=function(){return e(this.el).find(".help").empty()};ab.prototype.toggleCull=function(ac){this.widget.widget.formOptions.gene_length_correction=e(ac.target).is(":checked");return this.widget.widget.render()};ab.prototype.seeWhich=function(ad){var ac;ac=JSON.parse(this.pathQueryGeneLengthNull);this.cb(ac);return ad.preventDefault()};return ab})(L.View);C=(function(ab){c(aa,ab);function aa(){this.selectBackgroundList=i(this.selectBackgroundList,this);this.viewAction=i(this.viewAction,this);this.exportAction=i(this.exportAction,this);this.selectAllAction=i(this.selectAllAction,this);this.formAction=i(this.formAction,this);this.renderTableBody=i(this.renderTableBody,this);this.renderTable=i(this.renderTable,this);this.renderToolbar=i(this.renderToolbar,this);u=aa.__super__.constructor.apply(this,arguments);return u}aa.prototype.events={"click div.actions a.view":"viewAction","click div.actions a.export":"exportAction","change div.form select":"formAction","click div.content input.check":"selectAllAction"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}this.collection=new M();this.collection.bind("change",this.renderToolbar);return this.render()};aa.prototype.render=function(){var ad,ac;e(this.el).html(this.template("enrichment",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed,type:this.response.type}));e(this.el).find("div.form").html(this.template("enrichment.form",{options:this.form.options,pValues:this.form.pValues,errorCorrections:this.form.errorCorrections}));if(this.response.filterLabel!=null){e(this.el).find("div.form form").append(this.template("extra",{label:this.response.filterLabel,possible:this.response.filters.split(","),selected:this.response.filterSelectedValue}))}new J({el:e(this.el).find("div.form form"),lists:this.lists,current:this.response.current_population,loggedIn:this.response.is_logged,widget:this});if(this.response.extraAttribute){ad=JSON.parse(this.response.extraAttribute);if(ad.gene_length){ac=m(ad.gene_length,{el:e(this.el).find("div.form form"),widget:this,cb:this.options.resultsCb});new G(ac)}}if(this.response.current_list!=null){e(this.el).addClass("customBackgroundPopulation")}else{e(this.el).removeClass("customBackgroundPopulation")}if(this.response.results.length>0&&(this.response.message==null)){this.renderToolbar();this.renderTable()}else{e(this.el).find("div.content").html(e(this.template("noresults",{text:this.response.message||"No enrichment found."})))}this.widget.fireEvent({"class":"EnrichmentView",event:"rendered"});return this};aa.prototype.renderToolbar=function(){return e(this.el).find("div.actions").html(e(this.template("actions")))};aa.prototype.renderTable=function(){var ac,ae,af,ai,ag,ad,ah=this;e(this.el).find("div.content").html(e(this.template("enrichment.table",{label:this.response.label})));af=e(this.el).find("div.content table");ai=function(aj){var ak,al;ak=ah.response.results[aj];if(ah.response.externalLink){ak.externalLink=ah.response.externalLink+ak.identifier}al=new I(ak,ah.widget);return ah.collection.add(al)};for(ae=ag=0,ad=this.response.results.length;0<=ad?ag<ad:ag>ad;ae=0<=ad?++ag:--ag){ai(ae)}this.renderTableBody(af);ac=e(this.el).height()-e(this.el).find("div.header").height()-e(this.el).find("div.content table thead").height();e(this.el).find("div.content div.wrapper").css("height",""+ac+"px");e(this.el).find("div.content div.head").css("width",e(this.el).find("div.content table").width()+"px");af.find("thead th").each(function(aj,ak){return e(ah.el).find("div.content div.head div:eq("+aj+")").width(e(ak).width())});return af.css({"margin-top":"-"+af.find("thead").height()+"px"})};aa.prototype.renderTableBody=function(af){var ae,ah,ag,ac,ad;ae=document.createDocumentFragment();ad=this.collection.models;for(ag=0,ac=ad.length;ag<ac;ag++){ah=ad[ag];ae.appendChild(new q({model:ah,template:this.template,type:this.response.type,callbacks:{matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb},response:this.response,widget:this.widget}).el)}return af.find("tbody").html(ae)};aa.prototype.formAction=function(ac){this.widget.formOptions[e(ac.target).attr("name")]=e(ac.target[ac.target.selectedIndex]).attr("value");return this.widget.render()};aa.prototype.selectAllAction=function(){this.collection.toggleSelected();this.renderToolbar();return this.renderTableBody(e(this.el).find("div.content table"))};aa.prototype.exportAction=function(ah){var ae,ac,aj,af,ag,ad,ai=this;af=this.collection.selected();if(!af.length){af=this.collection.models}aj=[];for(ag=0,ad=af.length;ag<ad;ag++){ae=af[ag];aj.push(ae.get("identifier"))}ac=JSON.parse(this.response.pathQueryForMatches);ac.where.push({path:this.response.pathConstraint,op:"ONE OF",values:aj});return this.widget.queryRows(ac,function(aq){var at,am,ap,au,ao,an,al,ak;am={};for(ao=0,al=aq.length;ao<al;ao++){ap=aq[ao];if(am[ap[0]]==null){am[ap[0]]=[]}am[ap[0]].push(ap[1])}au=[];for(an=0,ak=af.length;an<ak;an++){ae=af[an];au.push([ae.get("description"),ae.get("p-value")].join("\t")+"\t"+am[ae.get("identifier")].join(","))}if(au.length){try{return new n(au.join("\n"),""+ai.widget.bagName+" "+ai.widget.id+".tsv")}catch(ar){at=ar;return new b(e(ah.target),au.join("\n"))}}})};aa.prototype.viewAction=function(){var af,ae,ai,ag,ah,ac,ad;ag=this.collection.selected();if(!ag.length){ag=this.collection.models}af=[];ai=[];for(ah=0,ac=ag.length;ah<ac;ah++){ae=ag[ah];af.push(ae.get("description"));ai.push(ae.get("identifier"))}if(ai.length){if((ad=this.popoverView)!=null){ad.remove()}return e(this.el).find("div.actions").after((this.popoverView=new X({identifiers:ai,description:af.join(", "),template:this.template,style:"width:300px",matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb,response:this.response,widget:this.widget})).el)}};aa.prototype.selectBackgroundList=function(ad,ac){if(ac==null){ac=false}if(ad==="Default"){ad=""}this.widget.formOptions.current_population=ad;this.widget.formOptions.remember_population=ac;return this.widget.render()};return aa})(L.View);U=(function(ab){c(aa,ab);function aa(){this.formAction=i(this.formAction,this);this.viewSeriesAction=i(this.viewSeriesAction,this);this.viewAllAction=i(this.viewAllAction,this);this.viewBarsAction=i(this.viewBarsAction,this);this.viewBarAction=i(this.viewBarAction,this);this.keypressAction=i(this.keypressAction,this);this.renderToolbar=i(this.renderToolbar,this);t=aa.__super__.constructor.apply(this,arguments);return t}aa.prototype.chartOptions={fontName:"Sans-Serif",fontSize:11,colors:["#2F72FF","#9FC0FF"],legend:{position:"top"},chartArea:{top:30,bottom:80,left:50},hAxis:{titleTextStyle:{fontName:"Sans-Serif"}},vAxis:{titleTextStyle:{fontName:"Sans-Serif"}}};aa.prototype.brewer={"3":["rgb(189,215,231)","rgb(107,174,214)","rgb(33,113,181)"],"4":["rgb(189,215,231)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],"5":["rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],"6":["rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],"7":["rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],"8":["rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,81,156)","rgb(8,48,107)"]};aa.prototype.multiselect=false;aa.prototype.events={"change div.form select":"formAction","click div.actions a.view-all":"viewAllAction"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}e(document).on("keyup keydown",this.keypressAction);return this.render()};aa.prototype.render=function(){var af,ac,ag,ad,ae,ah=this;e(this.el).html(this.template("chart",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed,type:this.response.type}));if(this.response.filterLabel!=null){e(this.el).find("div.form form").append(this.template("extra",{label:this.response.filterLabel,possible:this.response.filters.split(","),selected:this.response.filterSelectedValue}))}if(this.response.results.length>1){if(this.response.chartType in google.visualization){this.renderToolbar();ae=e(this.el).width();ac=e(this.el).height()-e(this.el).find("div.header").height();this.chartOptions.width=ae;this.chartOptions.chartArea.width=ae-this.chartOptions.chartArea.left;this.chartOptions.height=ac;this.chartOptions.chartArea.height=ac-this.chartOptions.chartArea.top-this.chartOptions.chartArea.bottom;this.chartOptions.hAxis={title:this.response.chartType==="BarChart"?this.response.rangeLabel:this.response.domainLabel};this.chartOptions.vAxis={title:this.response.chartType==="BarChart"?this.response.domainLabel:this.response.rangeLabel};af=new google.visualization[this.response.chartType](e(this.el).find("div.content")[0]);google.visualization.events.addListener(af,"click",function(){var ai;e(ah.el).find(".content").prepend(ai=e("<input/>",{"class":"focus",type:"text"}));return ai.focus().remove()});if(this.response.pathQuery!=null){google.visualization.events.addListener(af,"select",function(){return ah.viewBarAction(af)})}if(this.response.results[0].length===1){this.response.results[0]=[this.response.domainLabel,this.response.results[0][0]]}ad=JSON.parse(JSON.stringify(this.chartOptions));if(this.response.chartType==="PieChart"&&(ag=this.response.results.length-1)>=3){if(ag>8){ag=8}ad.colors=this.brewer[ag].reverse()}af.draw(google.visualization.arrayToDataTable(this.response.results,false),ad)}else{this.error({title:this.response.chartType,text:"This chart type does not exist in Google Visualization API"})}}else{e(this.el).find("div.content").html(e(this.template("noresults",{text:'No "'+this.response.title+'" with your list.'})))}this.widget.fireEvent({"class":"ChartView",event:"rendered"});return this};aa.prototype.renderToolbar=function(){return e(this.el).find("div.actions").html(e(this.template("chart.actions")))};aa.prototype.translate=function(ac,ad){if(ac.seriesValues!=null){return ac.seriesValues.split(",")[ac.seriesLabels.split(",").indexOf(ad)]}};aa.prototype.keypressAction=function(ac){if(ac.type==="keydown"){if(ac.keyCode>=16&&ac.keyCode<=18){return this.multiselect=true}}else{if(ac.keyCode>=16&&ac.keyCode<=18){this.multiselect=false;if((this.selection!=null)&&this.selection.length!==0){this.viewBarsAction(this.selection);return this.selection=null}}}};aa.prototype.viewBarAction=function(ag){var af,ai,ac,ad,aj,ae,ah;if(this.barView!=null){this.barView.close()}ae=ag.getSelection()[0];if(this.multiselect){if((ah=this.selection)==null){this.selection=[]}return this.selection.push(ae)}else{if(ae){ai="";ad=this.response.pathQuery;ac=this.response.simplePathQuery;if(ae.row!=null){aj=this.response.results[ae.row+1][0];ai+=aj;ad=ad.replace("%category",aj);ac=ac.replace("%category",aj);if(ae.column!=null){if(this.response.seriesPath==="ActualExpectedCriteria"&&ae.column===2){return false}af=this.response.results[0][ae.column];ai+=" "+af;ad=ad.replace("%series",this.translate(this.response,af));ac=ad.replace("%series",this.translate(this.response,af))}}else{if(ae.column!=null){return this.viewSeriesAction(ad.replace("%series",this.translate(this.response,this.response.results[0][ae.column])))}}ad=JSON.parse(ad);ac=JSON.parse(ac);if(ai){return e(this.el).find("div.content").append((this.barView=new O({description:ai,template:this.template,resultsPq:ad,resultsCb:this.options.resultsCb,listCb:this.options.listCb,matchCb:this.options.matchCb,quickPq:ac,widget:this.widget,type:this.response.type})).el)}}}};aa.prototype.viewBarsAction=function(ai){var ar,aq,af,al,ae,ac,am,ag,aj,ao,ap,an,au,ak,ah,at,ad;an=JSON.parse(this.response.pathQuery);ad=an.where;for(ao in ad){ag=ad[ao];switch(ag.value){case"%category":al=ag;break;case"%series":ak=ag;break;default:ag.code="A";af=ag}}an.where=[af,al,ak];an.constraintLogic="";ap=[];ae=66;am=[af];aj=function(aw){var ay,ax,av;for(ax=0,av=am.length;ax<av;ax++){ay=am[ax];if(ay.path===aw.path&&ay.value===aw.value){return ay.code}}};for(ah=0,at=ai.length;ah<at;ah++){au=ai[ah];if((au!=null)&&(al!=null)){ac=e.extend(true,{},al,{value:this.response.results[au.row+1][0]});ar=aj(ac);if(ar==null){ac.code=ar=String.fromCharCode(ae++).toUpperCase();am.push(ac)}if((au.column!=null)&&(ak!=null)){ac=e.extend(true,{},ak,{value:this.translate(this.response,this.response.results[0][au.column])});aq=aj(ac);if(aq==null){ac.code=aq=String.fromCharCode(ae++).toUpperCase();am.push(ac)}ap.push("("+[ar,aq].join(" AND ")+")")}else{ap.push(ar)}}}if(ae>90){throw"Too many constraints"}an.constraintLogic=["A","("+ap.join(" OR ")+")"].join(" AND ");an.where=am;if(ae>66){return this.options.resultsCb(an)}};aa.prototype.viewAllAction=function(){var ai,ae,ac,aj,ah,ad,ag,af;ac=JSON.parse(this.response.pathQuery);ag=["%category","%series"];for(ah=0,ad=ag.length;ah<ad;ah++){aj=ag[ah];af=ac.where;for(ae in af){ai=af[ae];if((ai!=null?ai.value:void 0)===aj){ac.where.splice(ae,1);break}}}return this.options.resultsCb(ac)};aa.prototype.viewSeriesAction=function(ae){var ag,ad,ac,af;ac=JSON.parse(ae);af=ac.where;for(ad in af){ag=af[ad];if((ag!=null?ag.value:void 0)==="%category"){ac.where.splice(ad,1);break}}return this.options.resultsCb(ac)};aa.prototype.formAction=function(ac){this.widget.formOptions[e(ac.target).attr("name")]=e(ac.target[ac.target.selectedIndex]).attr("value");return this.widget.render()};return aa})(L.View);X=(function(aa){c(ab,aa);function ab(){this.listAction=i(this.listAction,this);this.resultsAction=i(this.resultsAction,this);this.matchAction=i(this.matchAction,this);this.getPq=i(this.getPq,this);this.toggle=i(this.toggle,this);this.adjustPopover=i(this.adjustPopover,this);this.renderValues=i(this.renderValues,this);this.render=i(this.render,this);Z=ab.__super__.constructor.apply(this,arguments);return Z}ab.prototype.descriptionLimit=50;ab.prototype.valuesLimit=5;ab.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"toggle"};ab.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}return this.render()};ab.prototype.render=function(){var ac;e(this.el).css({position:"relative"});e(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:this.style||"width:300px;margin-left:-300px"}));ac=JSON.parse(this.response.pathQueryForMatches);ac.where.push({path:this.response.pathConstraint,op:"ONE OF",values:this.identifiers});this.widget.queryRows(ac,this.renderValues);return this};ab.prototype.renderValues=function(ae){var af,ah,ad,ag,ac;ad=[];for(ag=0,ac=ae.length;ag<ac;ag++){af=ae[ag];ah=(function(aj){var al,am,ai,ak;ak=aj.reverse();for(am=0,ai=ak.length;am<ai;am++){al=ak[am];if(al&&al.length>0){return al}}})(af);if(p.call(ad,ah)<0){ad.push(ah)}}e(this.el).find("div.values").html(this.template("popover.values",{values:ad,type:this.response.type,valuesLimit:this.valuesLimit,size:this.size}));return this.adjustPopover()};ab.prototype.adjustPopover=function(){var ac=this;return window.setTimeout((function(){var ai,ad,aj,ae,ah,af,ag;af=e(ac.el).closest("div.wrapper");ah=e(ac.el).find(".popover");ae=ah.closest("td.matches");if(!ae.length){return}ag=ae.closest("div.inner");aj=ag.find("div.header");ad=ag.find("div.content div.head");ai=((ae.position().top-aj.height()+ad.height())+ah.outerHeight())-af.height();if(ai>0){return ah.css("top",-ai)}}),0)};ab.prototype.toggle=function(){e(this.el).toggle();return this.adjustPopover()};ab.prototype.getPq=function(){var ac;ac=this.response.pathQuery;this.pq=JSON.parse(ac);return this.pq.where.push({path:this.response.pathConstraint,op:"ONE OF",values:this.identifiers})};ab.prototype.matchAction=function(ac){this.matchCb(e(ac.target).text(),this.response.type);return ac.preventDefault()};ab.prototype.resultsAction=function(){if(this.pq==null){this.getPq()}return this.resultsCb(this.pq)};ab.prototype.listAction=function(){if(this.pq==null){this.getPq()}return this.listCb(this.pq)};return ab})(L.View);N=(function(ab){c(aa,ab);function aa(){this.viewAction=i(this.viewAction,this);this.exportAction=i(this.exportAction,this);this.selectAllAction=i(this.selectAllAction,this);this.renderTableBody=i(this.renderTableBody,this);this.renderTable=i(this.renderTable,this);this.renderToolbar=i(this.renderToolbar,this);Y=aa.__super__.constructor.apply(this,arguments);return Y}aa.prototype.events={"click div.actions a.view":"viewAction","click div.actions a.export":"exportAction","click div.content input.check":"selectAllAction"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}this.collection=new s();this.collection.bind("change",this.renderToolbar);return this.render()};aa.prototype.render=function(){e(this.el).html(this.template("table",{title:this.options.title?this.response.title:"",description:this.options.description?this.response.description:"",notAnalysed:this.response.notAnalysed,type:this.response.type}));if(this.response.results.length>0){this.renderToolbar();this.renderTable()}else{e(this.el).find("div.content").html(e(this.template("noresults",{text:'No "'+this.response.title+'" with your list.'})))}this.widget.fireEvent({"class":"TableView",event:"rendered"});return this};aa.prototype.renderToolbar=function(){return e(this.el).find("div.actions").html(e(this.template("actions")))};aa.prototype.renderTable=function(){var ac,ae,af,ai,ag,ad,ah=this;e(this.el).find("div.content").html(e(this.template("table.table",{columns:this.response.columns.split(",")})));af=e(this.el).find("div.content table");ai=function(aj){var ak;ak=new E(ah.response.results[aj],ah.widget);return ah.collection.add(ak)};for(ae=ag=0,ad=this.response.results.length;0<=ad?ag<ad:ag>ad;ae=0<=ad?++ag:--ag){ai(ae)}this.renderTableBody(af);ac=e(this.el).height()-e(this.el).find("div.header").height()-e(this.el).find("div.content div.head").height();e(this.el).find("div.content div.wrapper").css("height",""+ac+"px");e(this.el).find("div.content div.head").css("width",e(this.el).find("div.content table").width()+"px");af.find("thead th").each(function(aj,ak){return e(ah.el).find("div.content div.head div:eq("+aj+")").width(e(ak).width())});return af.css({"margin-top":"-"+af.find("thead").height()+"px"})};aa.prototype.renderTableBody=function(af){var ad,ah,ag,ac,ae;ad=document.createDocumentFragment();ae=this.collection.models;for(ag=0,ac=ae.length;ag<ac;ag++){ah=ae[ag];ad.appendChild(new P({model:ah,template:this.template,response:this.response,matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb,widget:this.widget}).el)}return af.find("tbody").html(ad)};aa.prototype.selectAllAction=function(){this.collection.toggleSelected();this.renderToolbar();return this.renderTableBody(e(this.el).find("div.content table"))};aa.prototype.exportAction=function(ai){var af,ae,ac,ag,ah,ad;ag=this.collection.selected();if(!ag.length){ag=this.collection.models}ac=[this.response.columns.replace(/,/g,"\t")];for(ah=0,ad=ag.length;ah<ad;ah++){ae=ag[ah];ac.push(ae.get("descriptions").join("\t")+"\t"+ae.get("matches"))}if(ac.length){try{return new n(ac.join("\n"),""+this.widget.bagName+" "+this.widget.id+".tsv")}catch(aj){af=aj;return new b(e(ai.target),ac.join("\n"))}}};aa.prototype.viewAction=function(){var ae,ad,ai,ag,ah,ac,af;ag=this.collection.selected();if(!ag.length){ag=this.collection.models}ae=[];ai=[];for(ah=0,ac=ag.length;ah<ac;ah++){ad=ag[ah];ae.push(ad.get("descriptions")[0]);ai.push(ad.get("identifier"))}if(ai.length){if((af=this.popoverView)!=null){af.remove()}return e(this.el).find("div.actions").after((this.popoverView=new r({identifiers:ai,description:ae.join(", "),template:this.template,matchCb:this.options.matchCb,resultsCb:this.options.resultsCb,listCb:this.options.listCb,pathQuery:this.response.pathQuery,pathConstraint:this.response.pathConstraint,widget:this.widget,type:this.response.type,style:"width:300px"})).el)}};return aa})(L.View);r=(function(aa){c(ab,aa);function ab(){this.toggle=i(this.toggle,this);this.adjustPopover=i(this.adjustPopover,this);this.listAction=i(this.listAction,this);this.resultsAction=i(this.resultsAction,this);this.matchAction=i(this.matchAction,this);this.renderValues=i(this.renderValues,this);this.render=i(this.render,this);W=ab.__super__.constructor.apply(this,arguments);return W}ab.prototype.descriptionLimit=50;ab.prototype.valuesLimit=5;ab.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"toggle"};ab.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}return this.render()};ab.prototype.render=function(){e(this.el).css({position:"relative"});e(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:this.style||"width:300px;margin-left:-300px"}));this.pathQuery=JSON.parse(this.pathQuery);this.pathQuery.where.push({path:this.pathConstraint,op:"ONE OF",values:this.identifiers});this.widget.queryRows(this.pathQuery,this.renderValues);return this};ab.prototype.renderValues=function(ae){var af,ad,ag,ac;ad=[];for(ag=0,ac=ae.length;ag<ac;ag++){af=ae[ag];ad.push((function(ai){var aj,ak,ah;for(ak=0,ah=ai.length;ak<ah;ak++){aj=ai[ak];if(aj&&aj.length>0){return aj}}})(af))}e(this.el).find("div.values").html(this.template("popover.values",{values:ad,type:this.type,valuesLimit:this.valuesLimit,size:this.size}));return this.adjustPopover()};ab.prototype.matchAction=function(ac){this.matchCb(e(ac.target).text(),this.type);return ac.preventDefault()};ab.prototype.resultsAction=function(){return this.resultsCb(this.pathQuery)};ab.prototype.listAction=function(){return this.listCb(this.pathQuery)};ab.prototype.adjustPopover=function(){var ac=this;return window.setTimeout((function(){var ai,ad,aj,ae,ah,af,ag;af=e(ac.el).closest("div.wrapper");ah=e(ac.el).find(".popover");ae=ah.closest("td.matches");if(!ae.length){return}ag=ae.closest("div.inner");aj=ag.find("div.header");ad=ag.find("div.content div.head");ai=((ae.position().top-aj.height()+ad.height())+ah.outerHeight())-af.height();if(ai>0){return ah.css("top",-ai)}}),0)};ab.prototype.toggle=function(){e(this.el).toggle();return this.adjustPopover()};return ab})(L.View);O=(function(ab){c(aa,ab);function aa(){this.close=i(this.close,this);this.listAction=i(this.listAction,this);this.resultsAction=i(this.resultsAction,this);this.matchAction=i(this.matchAction,this);this.renderValues=i(this.renderValues,this);this.render=i(this.render,this);V=aa.__super__.constructor.apply(this,arguments);return V}aa.prototype.descriptionLimit=50;aa.prototype.valuesLimit=5;aa.prototype.events={"click a.match":"matchAction","click a.results":"resultsAction","click a.list":"listAction","click a.close":"close"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}return this.render()};aa.prototype.render=function(){e(this.el).html(this.template("popover",{description:this.description,descriptionLimit:this.descriptionLimit,style:"width:300px"}));this.widget.queryRows(this.quickPq,this.renderValues);return this};aa.prototype.renderValues=function(ae){var af,ad,ag,ac;ad=[];for(ag=0,ac=ae.length;ag<ac;ag++){af=ae[ag];ad.push((function(ai){var aj,ak,ah;for(ak=0,ah=ai.length;ak<ah;ak++){aj=ai[ak];if(aj&&aj.length>0){return aj}}})(af))}return e(this.el).find("div.values").html(this.template("popover.values",{values:ad,type:this.type,valuesLimit:this.valuesLimit,size:ad.length}))};aa.prototype.matchAction=function(ac){this.matchCb(e(ac.target).text(),this.type);return ac.preventDefault()};aa.prototype.resultsAction=function(){return this.resultsCb(this.resultsPq)};aa.prototype.listAction=function(){return this.listCb(this.resultsPq)};aa.prototype.close=function(){return e(this.el).remove()};return aa})(L.View);P=(function(aa){c(ab,aa);function ab(){this.toggleMatchesAction=i(this.toggleMatchesAction,this);this.selectAction=i(this.selectAction,this);this.render=i(this.render,this);T=ab.__super__.constructor.apply(this,arguments);return T}ab.prototype.tagName="tr";ab.prototype.events={"click td.check input":"selectAction","click td.matches a.count":"toggleMatchesAction"};ab.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}this.model.bind("change",this.render);return this.render()};ab.prototype.render=function(){e(this.el).html(this.template("table.row",{row:this.model.toJSON()}));return this};ab.prototype.selectAction=function(){this.model.toggleSelected();if(this.popoverView!=null){e(this.el).find("td.matches a.count").after(this.popoverView.el);return this.popoverView.delegateEvents()}};ab.prototype.toggleMatchesAction=function(ac){if(this.popoverView==null){return e(this.el).find("td.matches a.count").after((this.popoverView=new r({identifiers:[this.model.get("identifier")],description:this.model.get("descriptions").join(", "),template:this.template,matchCb:this.matchCb,resultsCb:this.resultsCb,listCb:this.listCb,pathQuery:this.response.pathQuery,pathConstraint:this.response.pathConstraint,widget:this.widget,type:this.response.type,size:e(ac.target).text()})).el)}else{return this.popoverView.toggle()}};return ab})(L.View);J=(function(ab){c(aa,ab);function aa(){this.selectListAction=i(this.selectListAction,this);this.filterAction=i(this.filterAction,this);this.toggleAction=i(this.toggleAction,this);this.renderLists=i(this.renderLists,this);this.render=i(this.render,this);S=aa.__super__.constructor.apply(this,arguments);return S}aa.prototype.events={"click .background a.change":"toggleAction","click .background a.close":"toggleAction","keyup .background input.filter":"filterAction","click .background table a":"selectListAction"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}return this.render()};aa.prototype.render=function(){e(this.el).append(this.widget.template("enrichment.population",{current:this.current!=null?this.current:"Default",loggedIn:this.loggedIn}));this.renderLists(this.lists);return this};aa.prototype.renderLists=function(ac){return e(this.el).find("div.values").html(this.widget.template("enrichment.populationlist",{lists:ac,current:this.current}))};aa.prototype.toggleAction=function(){return e(this.el).find("div.popover").toggle()};aa.prototype.filterAction=function(ac){var ad=this;if(this.timeout!=null){clearTimeout(this.timeout)}return this.timeout=setTimeout((function(){var ae,ag,af;ag=e(ac.target).val();if(ag!==ad.query){ad.query=ag;af=new RegExp(""+ag+".*","i");return ad.renderLists((function(){var ak,aj,ah,ai;ah=this.lists;ai=[];for(ak=0,aj=ah.length;ak<aj;ak++){ae=ah[ak];if(ae.name.match(af)){ai.push(ae)}}return ai}).call(ad))}}),500)};aa.prototype.selectListAction=function(ad){var ac;ac=e(ad.target).text();ad.preventDefault();this.toggleAction();return this.widget.selectBackgroundList(ac,e(this.el).find("input.save:checked").length===1)};return aa})(L.View);q=(function(ab){c(aa,ab);function aa(){this.toggleMatchesAction=i(this.toggleMatchesAction,this);this.selectAction=i(this.selectAction,this);this.render=i(this.render,this);R=aa.__super__.constructor.apply(this,arguments);return R}aa.prototype.tagName="tr";aa.prototype.events={"click td.check input":"selectAction","click td.matches a.count":"toggleMatchesAction"};aa.prototype.initialize=function(ae){var ad,ac;for(ad in ae){ac=ae[ad];this[ad]=ac}this.model.bind("change",this.render);return this.render()};aa.prototype.render=function(){e(this.el).html(this.template("enrichment.row",{row:this.model.toJSON()}));return this};aa.prototype.selectAction=function(){this.model.toggleSelected();if(this.popoverView!=null){e(this.el).find("td.matches a.count").after(this.popoverView.el);return this.popoverView.delegateEvents()}};aa.prototype.toggleMatchesAction=function(ac){if(this.popoverView==null){return e(this.el).find("td.matches a.count").after((this.popoverView=new X({matches:this.model.get("matches"),identifiers:[this.model.get("identifier")],description:this.model.get("description"),template:this.template,matchCb:this.callbacks.matchCb,resultsCb:this.callbacks.resultsCb,listCb:this.callbacks.listCb,response:this.response,widget:this.widget,size:e(ac.target).text()})).el)}else{return this.popoverView.toggle()}};return aa})(L.View);return{TableWidget:F,EnrichmentWidget:Q,ChartWidget:K,InterMineWidget:o,CoreModel:H,EnrichmentLengthCorrectionView:G,EnrichmentView:C,ChartView:U,EnrichmentPopoverView:X,TableView:N,TablePopoverView:r,ChartPopoverView:O,TableRowView:P,EnrichmentPopulationView:J,EnrichmentRowView:q}};e=window.jQuery||window.Zepto;h=(function(){o.prototype.VERSION="1.12.4";o.prototype.wait=true;o.prototype.resources={css:{Bootstrap:{path:"http://cdn.intermine.org/css/bootstrap/2.0.4-prefixed-no-icons/css/bootstrap.min.css"}},js:{JSON:{path:"http://cdn.intermine.org/js/json3/3.2.2/json3.min.js"},setImmediate:{path:"http://cdn.intermine.org/js/setImmediate/1.0.1/setImmediate.min.js"},async:{path:"http://cdn.intermine.org/js/async/0.2.6/async.min.js",depends:["setImmediate"]},jQuery:{path:"http://cdn.intermine.org/js/jquery/1.9.1/jquery-1.9.1.min.js"},_:{path:"http://cdn.intermine.org/js/underscore.js/1.3.3/underscore-min.js"},Backbone:{path:"http://cdn.intermine.org/js/backbone.js/1.0.0/backbone-min.js",depends:["jQuery","_"]},google:{path:"https://www.google.com/jsapi"},"intermine.imjs":{path:"http://cdn.intermine.org/js/intermine/imjs/2.6.0/im.js",depends:["jQuery","_"]},FileSaver:{path:"http://cdn.intermine.org/js/filesaver.js/FileSaver.min.js"}}};function o(){var q,r,s=this;r=1<=arguments.length?g.call(arguments,0):[];if(typeof r[0]==="string"){this.service=r[0];this.token=r[1]||""}else{if(r[0].root!=null){this.service=r[0].root}else{throw Error("You need to set the `root` parameter pointing to the mine's service")}this.token=r[0].token||""}q=function(t){if(t){throw t}e=window.jQuery;c(a,f(window.Backbone));return s.wait=false};if(r[0].skipDeps){q()}else{intermine.load(this.resources,q)}}o.prototype.chart=function(){var q,r,s=this;q=1<=arguments.length?g.call(arguments,0):[];return(r=function(){if(s.wait){return setTimeout(r,20)}return google.load("visualization","1.0",{packages:["corechart"],callback:function(){return(function(w,u,v){v.prototype=w.prototype;var x=new v,t=w.apply(x,u);return Object(t)===t?t:x})(a.ChartWidget,[s.service,s.token].concat(g.call(q)),function(){})}})})()};o.prototype.enrichment=function(){var q,r,s=this;q=1<=arguments.length?g.call(arguments,0):[];return(r=function(){if(s.wait){return setTimeout(r,20)}if(s.lists!=null){return(function(w,u,v){v.prototype=w.prototype;var x=new v,t=w.apply(x,u);return Object(t)===t?t:x})(a.EnrichmentWidget,[s.service,s.token,s.lists].concat(g.call(q)),function(){})}else{s.wait=true;return e.ajax({url:""+s.service+"lists?token="+s.token+"&format=json",dataType:"jsonp",success:function(t){if(t.statusCode!==200&&(t.lists==null)){return e(q[2]).html(e("<div/>",{"class":"alert alert-error",html:"Problem fetching lists we have access to <a href='"+s.service+"lists'>"+s.service+"lists</a>"}))}else{s.lists=t.lists;s.wait=false;return(function(x,v,w){w.prototype=x.prototype;var y=new w,u=x.apply(y,v);return Object(u)===u?u:y})(a.EnrichmentWidget,[s.service,s.token,s.lists].concat(g.call(q)),function(){})}},error:function(v,u,t){return e(el).html(e("<div/>",{"class":"alert alert-error",html:""+v.statusText+" for <a href='"+s.service+"widgets'>"+s.service+"widgets</a>"}))}})}})()};o.prototype.table=function(){var q,r,s=this;q=1<=arguments.length?g.call(arguments,0):[];return(r=function(){if(s.wait){return setTimeout(r,20)}return(function(w,u,v){v.prototype=w.prototype;var x=new v,t=w.apply(x,u);return Object(t)===t?t:x})(a.TableWidget,[s.service,s.token].concat(g.call(q)),function(){})})()};o.prototype.all=function(r,s,q,u){var t,v=this;if(r==null){r="Gene"}return(t=function(){if(v.wait){return setTimeout(t,20)}return e.ajax({url:""+v.service+"widgets?format=json",dataType:"jsonp",success:function(A){var C,z,B,y,w,x;if(A.widgets){w=A.widgets;x=[];for(B=0,y=w.length;B<y;B++){C=w[B];if(!(p.call(C.targets,r)>=0)){continue}z=C.name.replace(/[^-a-zA-Z0-9,&\s]+/ig,"").replace(/-/gi,"_").replace(/\s/gi,"-").toLowerCase();e(q).append(e("<div/>",{id:z,"class":"widget span6"}));switch(C.widgetType){case"chart":x.push(v.chart(C.name,s,""+q+" #"+z,u));break;case"enrichment":x.push(v.enrichment(C.name,s,""+q+" #"+z,u));break;case"table":x.push(v.table(C.name,s,""+q+" #"+z,u));break;default:x.push(void 0)}}return x}},error:function(y,x,w){return e(q).html(e("<div/>",{"class":"alert alert-error",html:""+y.statusText+" for <a href='"+v.service+"widgets'>"+v.service+"widgets</a>"}))}})})()};return o})();if(!window.intermine&&window.intermine.load){throw"You need to include the InterMine API Loader first!"}else{window.intermine.widgets=h}}).call(this);