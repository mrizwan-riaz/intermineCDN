!function(){function a(b,c,d){var e=a.resolve(b);if(null==e){d=d||b,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=a.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,a.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports}a.modules={},a.aliases={},a.resolve=function(b){"/"===b.charAt(0)&&(b=b.slice(1));for(var c=[b,b+".js",b+".json",b+"/index.js",b+"/index.json"],d=0;d<c.length;d++){var b=c[d];if(a.modules.hasOwnProperty(b))return b;if(a.aliases.hasOwnProperty(b))return a.aliases[b]}},a.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!=b[d]&&""!=b[d]&&c.push(b[d]);return a.concat(c).join("/")},a.register=function(b,c){a.modules[b]=c},a.alias=function(b,c){if(!a.modules.hasOwnProperty(b))throw new Error('Failed to alias "'+b+'", it does not exist');a.aliases[c]=b},a.relative=function(b){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function d(c){var e=d.resolve(c);return a(e,b,c)}var e=a.normalize(b,"..");return d.resolve=function(d){var f=d.charAt(0);if("/"==f)return d.slice(1);if("."==f)return a.normalize(e,d);var g=b.split("/"),h=c(g,"deps")+1;return h||(h=0),d=g.slice(0,h+1).join("/")+"/deps/"+d},d.exists=function(b){return a.modules.hasOwnProperty(d.resolve(b))},d};var b=this;b.require=a="undefined"!=typeof b.require?b.require:a,function(){a.register("pomme.js/src/channel.js",function(a,b,c){var d,e,f,g,h,i,j,k,l=function(a,b){return function(){return a.apply(b,arguments)}},m=[].slice;i=b("./iframe"),h=b("./helpers"),k=b("./router"),d=k.ChanID,f=k.FnID,j=k.router,g=b("./constants"),e=function(){function a(a){this.onMessage=l(this.onMessage,this),this.onReady=l(this.onReady,this);var b,c,e,f=this;if(null==a&&(a={}),c=a.target,b=a.scope,e=a.template,this.id=(new d).id,b&&(this.scope=b),!_.isString(this.scope))throw"only strings accepted for a scope";switch(!1){case!_.isWindow(c):this.window=c;break;case!c:this.window=(this.iframe=new i({id:this.id,target:c,scope:this.scope,template:e})).el;break;default:this.window=window.parent,this.child=!0}if(window===this.window)throw"child and parent windows cannot be one and the same";this.handlers={},this.pending=[],j.register(this.window,this.scope,this.onMessage),this.on(g.ready,this.onReady),this.on("eval",function(a){return eval.call(f,a)}),h.nextTick(function(){return f.postMessage({method:f.scopeMethod(g.ready),params:["ping"]},!0)})}return a.prototype.ready=!1,a.prototype.scope="testScope",a.prototype.onReady=function(a){var b;if(this.ready)return this.error("received ready message while in ready state");for(this.id+=[":B",":A"]["ping"===+a],this.unbind(g.ready),this.ready=!0,"ping"===a&&this.trigger(g.ready,"pong"),b=[];this.pending.length;)b.push(this.postMessage(this.pending.pop()));return b},a.prototype.trigger=function(){var a,b,c,d,e,g=this;c=arguments[0],d=2<=arguments.length?m.call(arguments,1):[];try{JSON.stringify(d)}catch(h){return b=h,this.error("cannot convert circular structure")}return e=(a=function(b){var c;if(_.isFunction(b))return c=(new f).id,g.on(c,b),c;switch(!1){case!_.isArray(b):return _.collect(b,a);case!_.isObject(b):return _.transform(b,function(b,c,d){return b[d]=a(c)});default:return b}})(d),this.postMessage({method:this.scopeMethod(c),params:e}),this},a.prototype.postMessage=function(a,b){return null==b&&(b=!1),this.disposed?void 0:b||this.ready?(a[g.postmessage]=!0,this.window.postMessage(JSON.stringify(a),"*")):this.pending.push(a)},a.prototype.onMessage=function(a,b){var c,d,e,f=this;if(b=(e=function(a){switch(!1){case!_.isArray(a):return _.collect(a,e);case!_.isObject(a):return _.transform(a,function(a,b,c){return a[c]=e(b)});case!(_.isString(a)&&a.match(g["function"])):return function(){return f.trigger.apply(f,[a].concat(_.toArray(arguments)))};default:return a}})(b),_.isFunction(d=this.handlers[a])){_.isArray(b)||(b=[b]);try{return d.apply(null,b)}catch(h){return c=h,this.error(c)}}},a.prototype.scopeMethod=function(a){return[this.scope,a].join("::")},a.prototype.on=function(a,b){return this.disposed?void 0:a&&_.isString(a)?b&&_.isFunction(b)?this.handlers[a]?this.error("`"+a+"` is already bound"):(this.handlers[a]=b,this):this.error("callback missing"):this.error("`method` must be string")},a.prototype.unbind=function(a){return a in this.handlers?delete this.handlers[a]:this.error("`"+a+"` is not bound")},a.prototype.error=function(a){var b,c;switch(b=null,!1){case!_.isString(a):b=a;break;case!_.isArray(a):b=a[1];break;case!(_.isObject(a)&&_.isString(a.message)):b=a.message}if(!b)try{b=JSON.stringify(a)}catch(d){b=a.toString()}return this.child?_.isFunction(this.handlers.error)?this.handlers.error(b):this.trigger("error",b):(null==(c=this.handlers).error&&(c.error=function(){}),this.handlers.error(b))},a.prototype.dispose=function(){var a,b,c,d;if(!this.disposed){this.disposed=!0,null!=(c=this.iframe)&&c.dispose(),d=this.handlers;for(a in d)b=d[a],"error"!==a&&this.unbind(a);return"function"==typeof Object.freeze&&Object.freeze(this.handlers),"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}(),c.exports=e,_.mixin(function(){return{isWindow:function(a){switch(!1){case!!_.isObject(a):return!1;default:return a.window===a}},transform:function(a,b){var c,d;for(c in a)d=a[c],b(a,d,c);return a}}}())}),a.register("pomme.js/src/constants.js",function(a,b,c){c.exports={postmessage:"__pomme__","function":"__function::",iframe:"__pomme::",ready:"__ready"}}),a.register("pomme.js/src/helpers.js",function(a,b,c){var d;d=window,c.exports={nextTick:function(){var a,b;switch(!1){case!("setImmediate"in d&&_.isFunction(d.setImmediate)):return function(a){return setImmediate(a)};case!("undefined"==typeof d||"ActiveXObject"in d||!1 in d):return function(a){return setTimeout(a)};default:return a=[],b=function(){return d.postMessage("tick","*")},d.addEventListener("message",function(){var c,d,e;for(e=[];a.length;){d=a.shift();try{e.push(d())}catch(f){throw c=f,b(),c}}return e},!0),function(c){return a.length||b(),a.push(c)}}}()}}),a.register("pomme.js/src/iframe.js",function(a,b,c){var d,e;d=b("./constants"),e=function(){function a(a){var b,c,e,f,g,h;c=a.id,g=a.target,f=a.scope,h=a.template;try{document.querySelector(g)}catch(i){return this.error("target selector not found")}return e=d.iframe+c||+new Date,this.node=document.createElement("iframe"),this.node.name=e,document.querySelector(g).appendChild(this.node),_.isFunction(h)?_.isString(b=h({scope:f}))?(this.node.contentWindow.document.open(),this.node.contentWindow.document.write(b),this.node.contentWindow.document.close(),this.el=window.frames[e],void 0):this.error("template did not return a string"):this.error("template is not a function")}return a.prototype.error=function(a){throw this.dispose(),a},a.prototype.dispose=function(){if(!this.disposed){if(this.disposed=!0,this.node)switch(!1){case!_.isFunction(this.node.remove):this.node.remove();break;case!_.isFunction(this.node.removeNode):this.node.removeNode(!0);break;case!this.node.parentNode:this.node.parentNode.removeChild(this.node)}return"function"==typeof Object.freeze?Object.freeze(this):void 0}},a}(),c.exports=e}),a.register("pomme.js/src/router.js",function(a,b,c){var d,e,f,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};if(g=b("./constants"),f=function(){function a(){this.route=i(this.route,this)}return a.prototype.table={},a.prototype.transactions={},a.prototype.register=function(a,b,c){var d,e,f,g,h;for(null==b&&(b=""),null==(e=this.table)[b]&&(e[b]=[]),h=this.table[b],f=0,g=h.length;g>f;f++)if(d=h[f],d.win===a)throw"a channel is already bound to the same window under `"+b+"`";return this.table[b].push({win:a,handler:c})},a.prototype.route=function(a){var b,c,d,e,f,h,i,k,l;b=null;try{b=JSON.parse(a.data)}catch(m){}if(_.isObject(b)&&(i=g.postmessage,j.call(_.keys(b),i)>=0)&&(e=null,c=null,_.isString(b.method)&&(k=b.method.match(/^([^:]+)::(.+)$/).slice(1,3),e=k[0],c=k[1],e&&c||(c=b.method)),c&&null!=this.table[e]))for(l=this.table[e],f=0,h=l.length;h>f;f++)if(d=l[f],d.win===a.source)return d.handler(c,b.params)},a}(),d=function(){function a(){this.id=a.prototype._id++}return a.prototype._id=0,a}(),e=function(){function a(){this.id=g["function"]+a.prototype._id++}return a.prototype._id=0,a}(),!("postMessage"in window))throw"cannot run in this browser, no postMessage";switch(h=new f,!1){case!("addEventListener"in window):window.addEventListener("message",h.route,!1);break;case!("attachEvent"in window):window.attachEvent("onmessage",h.route)}c.exports={ChanID:d,FnID:e,router:h}})}();var c=a("pomme.js/src/channel.js");"undefined"!=typeof define&&define.amd?(define("pomme.js",[],function(){return c}),define("Pomme.js",[],function(){return c}),define("pommejs",[],function(){return c}),define("PommeJS",[],function(){return c}),define("pomme",[],function(){return c}),define("Pomme",[],function(){return c})):"undefined"!=typeof module&&module.exports?module.exports=c:(b["pomme.js"]=c,b["Pomme.js"]=c,b.pommejs=c,b.PommeJS=c,b.pomme=c,b.Pomme=c),a.alias("pomme.js/src/channel.js","pomme.js/index.js"),a.alias("pomme.js/src/channel.js","Pomme.js/index.js"),a.alias("pomme.js/src/channel.js","pommejs/index.js"),a.alias("pomme.js/src/channel.js","PommeJS/index.js"),a.alias("pomme.js/src/channel.js","pomme/index.js"),a.alias("pomme.js/src/channel.js","Pomme/index.js")}();